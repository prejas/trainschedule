<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>PhoneGap</title>
<script src="../HelloGap/assets/www/trainSchedule.js"/>
<script type="text/javascript" charset="utf-8" src="cordova-2.2.0.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
	<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
	<script src="http://code.jquery.com/jquery-latest.js"></script>
	<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" /> 
	<script src="http://code.jquery.com/jquery-1.8.3.js"></script> 
	<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script> 
	<link rel="stylesheet" href="/resources/demos/style.css" /> 	
	

<script>       
        $.support.cors = true
	      	$.ajax({
			    type: "GET",
	        	contentType: 'application/json; charset=utf-8',
	        	url: "http://192.168.1.178:8080/TrainRestService/rest/trainservice/stnames", 
			    success: function(responseData) {
			    	console.log("responseData: " + responseData);
			    	console.log("obj: " + responseData.trainSchedulePojo[0].stationName);
			    	
			    	for (var i=0; i<responseData.trainSchedulePojo.length; i++){
				      $('#fromStation').append('<option value="'+responseData.trainSchedulePojo[i].stationName+ '" class="dropDownBlk">'+responseData.trainSchedulePojo[i].stationName+'</option>');
				    }
				    
				    for (var i=0; i<responseData.trainSchedulePojo.length; i++){
				      $('#toStation').append('<option value="'+responseData.trainSchedulePojo[i].stationName+ '" class="dropDownBlk">'+responseData.trainSchedulePojo[i].stationName+'</option>');
				    }
			    	
			    },
			    error: function(XMLHttpRequest, textStatus, errorThrown) {
			        //TODO  
			    }
			});  	     

	  	$(function() {
			$( "#datepicker" ).datepicker({
				showOn: "button",
				buttonImage: "images/calendar.gif",
				buttonImageOnly: true
			});
		});
	
	
	function getDescription() {
		var fromStation = document.getElementById("fromStation").value;
		var toStation = document.getElementById("toStation").value;		
		
		$.support.cors = true
		$.ajax({
		    type: "GET",
        	contentType: 'application/json; charset=utf-8',
        	url: "http://192.168.1.178:8080/TrainRestService/rest/trainservice/schtrains?fromStation=PUNE&toStation=MUMBAI&time=2012-12-18%2017:23:27", 
		    success: function(responseData) {
		    	console.log("responseData" +responseData);
		    	console.log("obj: " + responseData.trainSchedulePojo.length);
		    	var trainScheduledTable = document.getElementById("trainScheduleTable");
			    var trainScheduledRow = trainScheduledTable.rows;
				if(trainScheduledRow.length>1){
		            for(var j=(trainScheduledRow.length-1);j>0;j--){
		                trainScheduledTable.deleteRow(j);
		            }
		        }
		    	if (responseData.trainSchedulePojo.length > 1) {    	
			        
					for (var i=0;i<responseData.trainSchedulePojo.length;i++) {			      
			            trainScheduledRow = trainScheduledTable.rows;           
			            var newRow = trainScheduledTable.insertRow(trainScheduledRow.length);			                
			            newRow.insertCell(0).innerHTML = responseData.trainSchedulePojo[i].trainNo;
			            newRow.insertCell(1).innerHTML = responseData.trainSchedulePojo[i].trainName;            
			            newRow.insertCell(2).innerHTML = responseData.trainSchedulePojo[i].trainTime;  
	            	}
            	} else {           		
						      
		            trainScheduledRow = trainScheduledTable.rows;           
		            var newRow = trainScheduledTable.insertRow(trainScheduledRow.length);		                       
		            newRow.insertCell(0).innerHTML = responseData.trainSchedulePojo.trainNo;
		            newRow.insertCell(1).innerHTML = responseData.trainSchedulePojo.trainName;            
		            newRow.insertCell(2).innerHTML = responseData.trainSchedulePojo.trainTime;             	
            		
            	}
		    },
		    error: function(XMLHttpRequest, textStatus, errorThrown) {
		        //TODO  
		    }
		});				
	}
</script>
</head>
	<body>
		<form>
			<h3><center> Train Schedule </center></h3>
			<div>
			   <fieldset>			   	
			   		<table width="100%">
			   			<tr>
			   				<td width="20%">
			   					From Station
			   				</td>
			   				<td>
			   					<select id="fromStation" size="1">	
			   						<option>Select</option>	 								
		    					</select>
			   				<td>
			   			</tr>
			   			<tr>
			   				<td width="20%">
			   					To Station
			   				</td>
			   				<td>
			   					<select id="toStation" size="1">
			   						<option>Select</option>	   					
			   					</select>
			   				<td>
			   			</tr>
			   			<tr>  
						   <td>
						   		Date/Time
					   		</td>  
						   <td>
						   		<input type="text" id="datepicker" size="10" maxlength="10"/>						   		
						   </tr>  
			   		</table>
			   </fieldset>
			</div>
			<table>
				<tr>
					<td>
						<input type="button" id="show" value="Show" onclick="getDescription();"/>
					</td>
				</tr>
			</table>
			<div align="center">
		        <fieldset>
		            <table width="100%" border="1" align="center" id="trainScheduleTable">
		                <tr>
		                    <td align="center" bgcolor="#336699" style="color:white">
		                        Sr. No.
		                    </td>
		                    <td align="center" bgcolor="#336699" style="color:white">
		                        Train Name
		                    </td>
		                    <td align="center" bgcolor="#336699" style="color:white">
		                        Train Time
		                    </td>
		                </tr>
		        	</table>
		    	</fieldset>
			</div>                       
		</form>
	</body>
</html>